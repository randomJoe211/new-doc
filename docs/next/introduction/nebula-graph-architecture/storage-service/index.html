<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-introduction/nebula-graph-architecture/storage-service">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Storage Service | NebulaGraph Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://randomjoe211.github.io/docs/next/introduction/nebula-graph-architecture/storage-service/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Storage Service | NebulaGraph Documentation"><meta data-rh="true" name="description" content="The persistent data of Nebula Graph have two parts. One is the Meta Service that stores the meta-related data."><meta data-rh="true" property="og:description" content="The persistent data of Nebula Graph have two parts. One is the Meta Service that stores the meta-related data."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://randomjoe211.github.io/docs/next/introduction/nebula-graph-architecture/storage-service/"><link data-rh="true" rel="alternate" href="https://randomjoe211.github.io/docs/next/introduction/nebula-graph-architecture/storage-service/" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://randomjoe211.github.io/zh-Hans/docs/next/introduction/nebula-graph-architecture/storage-service/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://randomjoe211.github.io/docs/next/introduction/nebula-graph-architecture/storage-service/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.3fb2f4f0.css">
<link rel="preload" href="/assets/js/runtime~main.e8bfd649.js" as="script">
<link rel="preload" href="/assets/js/main.e9b606a3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#cccccc;color:#000" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">This is a test website for NebulaGraph docs.</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.ico" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/favicon.ico" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">NebulaGraph Academy</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/intro/">Database</a></li><li><a class="dropdown__link" href="/cloud/what-is-cloud/">Cloud</a></li></ul></div><a class="navbar__item navbar__link" href="/training/">Training</a><a href="https://academic.nebula-graph.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Certifications</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/next/intro/">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/introduction/nebula-graph-architecture/storage-service/">Next</a></li><li><a class="dropdown__link" href="/docs/introduction/nebula-graph-architecture/storage-service/">1.1.0</a></li><li><a class="dropdown__link" href="/docs/1.0.0/introduction/nebula-graph-architecture/storage-service/">1.0.0</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/next/introduction/nebula-graph-architecture/storage-service/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en-GB">English</a></li><li><a href="/zh-Hans/docs/next/introduction/nebula-graph-architecture/storage-service/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/vesoft-inc/nebula-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/favicon.ico" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/favicon.ico" alt="" class="themedImage_ToTc themedImage--dark_i4oU"><b>NebulaGraph Academy</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/intro/">NebulaGraph Database</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/next/category/introduction/">Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/graph/">An introduction to graphs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/graph-database/">Market overview of graph databases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/related-tech/">Related technologies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/what-is-nebula-graph/">What is Nebula Graph</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/next/category/nebulagraph-architecture/">NebulaGraph Architecture</a><button aria-label="Toggle the collapsible sidebar category &#x27;NebulaGraph Architecture&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/nebula-graph-architecture/architecture-overview/">Architecture overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/nebula-graph-architecture/meta-service/">Meta Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/nebula-graph-architecture/graph-service/">Graph Service</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/next/introduction/nebula-graph-architecture/storage-service/">Storage Service</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/data-model/">Data modeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/path/">Path types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/introduction/vid/">VID</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->NebulaGraph Documentation<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/introduction/nebula-graph-architecture/storage-service/">latest version</a></b> (<!-- -->1.1.0<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/next/category/introduction/"><span itemprop="name">Introduction</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/next/category/nebulagraph-architecture/"><span itemprop="name">NebulaGraph Architecture</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Storage Service</span><meta itemprop="position" content="3"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Storage Service</h1><p>The persistent data of Nebula Graph have two parts. One is the <a href="/docs/next/introduction/nebula-graph-architecture/meta-service/">Meta Service</a> that stores the meta-related data.</p><p>The other is the Storage Service that stores the data, which is run by the nebula-storaged process. This topic will describe the architecture of the Storage Service.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="advantages">Advantages<a class="hash-link" href="#advantages" title="Direct link to heading">​</a></h2><ul><li><p>High performance (Customized built-in KVStore)</p></li><li><p>Great scalability (Shared-nothing architecture, not rely on NAS/SAN-like devices)</p></li><li><p>Strong consistency (Raft)</p></li><li><p>High availability (Raft)</p></li><li><p>Supports synchronizing with the third party systems, such as <a href="/docs/next/introduction/4.deployment-and-installation/6.deploy-text-based-index/2.deploy-es.md/">Elasticsearch</a>.</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-architecture-of-the-storage-service">The architecture of the Storage Service<a class="hash-link" href="#the-architecture-of-the-storage-service" title="Direct link to heading">​</a></h2><p><img loading="lazy" src="https://www-cdn.nebula-graph.com.cn/nebula-blog/nebula-reading-storage-architecture.png" alt="image" class="img_ev3q"></p><p>The Storage Service is run by the nebula-storaged process. Users can deploy nebula-storaged processes on different occasions. For example, users can deploy 1 nebula-storaged process in a test environment and deploy 3 nebula-storaged processes in a production environment.</p><p>All the nebula-storaged processes consist of a Raft-based cluster. There are three layers in the Storage Service:</p><ul><li><p>Storage interface</p><p> The top layer is the storage interface. It defines a set of APIs that are related to the graph concepts. These API requests will be translated into a set of KV operations targeting the corresponding <a href="#data_partitioning">Partition</a>. For example:</p><ul><li><p><code>getNeighbors</code>: queries the in-edge or out-edge of a set of vertices, returns the edges and the corresponding properties, and supports conditional filtering.</p></li><li><p><code>insert vertex/edge</code>: inserts a vertex or edge and its properties.</p></li><li><p><code>getProps</code>: gets the properties of a vertex or an edge.</p></li></ul><p>It is this layer that makes the Storage Service a real graph storage. Otherwise, it is just a KV storage.</p></li><li><p>Consensus</p><p>Below the storage interface is the consensus layer that implements <a href="#multi_group_raft">Multi Group Raft</a>, which ensures the strong consistency and high availability of the Storage Service.</p></li><li><p>Store engine</p><p>The bottom layer is the local storage engine library, providing operations like <code>get</code>, <code>put</code>, and <code>scan</code> on local disks. The related interfaces are stored in <code>KVStore.h</code> and <code>KVEngine.h</code> files. You can develop your own local store plugins based on your needs.</p></li></ul><p>The following will describe some features of the Storage Service based on the above architecture.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="storage-writing-process">Storage writing process<a class="hash-link" href="#storage-writing-process" title="Direct link to heading">​</a></h2><p><img loading="lazy" src="https://docs-cdn.nebula-graph.com.cn/figures/storage_write_process.png" alt="image" class="img_ev3q"></p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="kvstore">KVStore<a class="hash-link" href="#kvstore" title="Direct link to heading">​</a></h2><p>Nebula Graph develops and customizes its built-in KVStore for the following reasons.</p><ul><li><p>It is a high-performance KVStore.</p></li><li><p>It is provided as a (kv) library and can be easily developed for the filter pushdown purpose. As a strong-typed database, how to provide Schema during pushdown is the key to efficiency for Nebula Graph.</p></li><li><p>It has strong data consistency.</p></li></ul><p>Therefore, Nebula Graph develops its own KVStore with RocksDB as the local storage engine. The advantages are as follows.</p><ul><li><p>For multiple local hard disks, Nebula Graph can make full use of its concurrent capacities through deploying multiple data directories.</p></li><li><p>The Meta Service manages all the Storage servers. All the partition distribution data and current machine status can be found in the meta service. Accordingly, users can execute a manual load balancing plan in meta service.</p><p>!!! Note</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  Nebula Graph does not support auto load balancing because auto data transfer will affect online business.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>Nebula Graph provides its own WAL mode so one can customize the WAL. Each partition owns its WAL.</p></li><li><p>One Nebula Graph KVStore cluster supports multiple graph spaces, and each graph space has its own partition number and replica copies. Different graph spaces are isolated physically from each other in the same cluster.</p></li></ul><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-storage-structure">Data storage structure<a class="hash-link" href="#data-storage-structure" title="Direct link to heading">​</a></h2><p>Graphs consist of vertices and edges. Nebula Graph uses key-value pairs to store vertices, edges, and their properties. Vertices and edges are stored in keys and their properties are stored in values. Such structure enables efficient property filtering.</p><ul><li><p>The storage structure of vertices</p><p>Different from Nebula Graph version 2.x, version 3.x added a new key for each vertex. Compared to the old key that still exists, the new key has no <code>TagID</code> field and no value. Vertices in Nebula Graph can now live without tags owing to the new key.</p><p>  <img loading="lazy" src="https://docs-cdn.nebula-graph.com.cn/figures/3.0-vertex-key.png" alt="The vertex structure of Nebula Graph" class="img_ev3q"></p><table><thead><tr><th align="left">Field</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>Type</code></td><td align="left">One byte, used to indicate the key type.</td></tr><tr><td align="left"><code>PartID</code></td><td align="left">Three bytes, used to indicate the sharding partition and to scan the partition data based on the prefix when re-balancing the partition.</td></tr><tr><td align="left"><code>VertexID</code></td><td align="left">The vertex ID. For an integer VertexID, it occupies eight bytes. However, for a string VertexID, it is changed to <code>fixed_string</code> of a fixed length which needs to be specified by users when they create the space.</td></tr><tr><td align="left"><code>TagID</code></td><td align="left">Four bytes, used to indicate the tags that vertex relate with.</td></tr><tr><td align="left"><code>SerializedValue</code></td><td align="left">The serialized value of the key. It stores the property information of the vertex.</td></tr></tbody></table></li><li><p>The storage structure of edges</p><p>  <img loading="lazy" src="https://docs-cdn.nebula-graph.com.cn/figures/3.0-edge-key.png" alt="The edge structure of Nebula Graph" class="img_ev3q"></p><table><thead><tr><th align="left">Field</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>Type</code></td><td align="left">One byte, used to indicate the key type.</td></tr><tr><td align="left"><code>PartID</code></td><td align="left">Three bytes, used to indicate the partition ID. This field can be used to scan the partition data based on the prefix when re-balancing the partition.</td></tr><tr><td align="left"><code>VertexID</code></td><td align="left">Used to indicate vertex ID. The former VID refers to the source VID in the outgoing edge and the dest VID in the incoming edge, while the latter VID refers to the dest VID in the outgoing edge and the source VID in the incoming edge.</td></tr><tr><td align="left"><code>Edge Type</code></td><td align="left">Four bytes, used to indicate the edge type. Greater than zero indicates out-edge, less than zero means in-edge.</td></tr><tr><td align="left"><code>Rank</code></td><td align="left">Eight bytes, used to indicate multiple edges in one edge type. Users can set the field based on needs and store weight, such as transaction time and transaction number.</td></tr><tr><td align="left"><code>PlaceHolder</code></td><td align="left">One byte. Reserved.</td></tr><tr><td align="left"><code>SerializedValue</code></td><td align="left">The serialized value of the key. It stores the property information of the edge.</td></tr></tbody></table></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="property-descriptions">Property descriptions<a class="hash-link" href="#property-descriptions" title="Direct link to heading">​</a></h3><p>Nebula Graph uses strong-typed Schema.</p><p>Nebula Graph will store the properties of vertex and edges in order after encoding them. Since the length of properties is fixed, queries can be made in no time according to offset. Before decoding, Nebula Graph needs to get (and cache) the schema information in the Meta Service. In addition, when encoding properties, Nebula Graph will add the corresponding schema version to support online schema change.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-partitioning">Data partitioning<a class="hash-link" href="#data-partitioning" title="Direct link to heading">​</a></h2><p>Since in an ultra-large-scale relational network, vertices can be as many as tens to hundreds of billions, and edges are even more than trillions. Even if only vertices and edges are stored, the storage capacity of both exceeds that of ordinary servers. Therefore, Nebula Graph uses hash to shard the graph elements and store them in different partitions.</p><p><img loading="lazy" src="https://www-cdn.nebula-graph.com.cn/nebula-blog/DataModel02.png" alt="data partitioning" class="img_ev3q"></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="edge-partitioning-and-storage-amplification">Edge partitioning and storage amplification<a class="hash-link" href="#edge-partitioning-and-storage-amplification" title="Direct link to heading">​</a></h3><p>In Nebula Graph, an edge corresponds to two key-value pairs on the hard disk. When there are lots of edges and each has many properties, storage amplification will be obvious. The storage format of edges is shown in the figure below.</p><p><img loading="lazy" src="https://docs-cdn.nebula-graph.com.cn/figures/edge-division.png" alt="partitioning by edge" class="img_ev3q"></p><p>In this example, ScrVertex connects DstVertex via EdgeA, forming the path of <code>(SrcVertex)-[EdgeA]-&gt;(DstVertex)</code>. ScrVertex, DstVertex, and EdgeA will all be stored in Partition x and Partition y as four key-value pairs in the storage layer. Details are as follows:</p><ul><li><p>The key value of SrcVertex is stored in Partition x. Key fields include Type, PartID(x), VID(Src), and TagID. SerializedValue, namely Value, refers to serialized vertex properties.</p></li><li><p>The first key value of EdgeA, namely EdgeA_Out, is stored in the same partition as the ScrVertex. Key fields include Type, PartID(x), VID(Src), EdgeType(+ means out-edge), Rank(0), VID(Dst), and PlaceHolder. SerializedValue, namely Value, refers to serialized edge properties.</p></li><li><p>The key value of DstVertex is stored in Partition y. Key fields include Type, PartID(y), VID(Dst), and TagID. SerializedValue, namely Value, refers to serialized vertex properties.</p></li><li><p>The second key value of EdgeA, namely EdgeA_In, is stored in the same partition as the DstVertex. Key fields include Type, PartID(y), VID(Dst), EdgeType(- means in-edge), Rank(0), VID(Src), and PlaceHolder. SerializedValue, namely Value, refers to serialized edge properties, which is exactly the same as that in EdgeA_Out.</p></li></ul><p>EdgeA_Out and EdgeA_In are stored in storage layer with opposite directions, constituting EdgeA logically. EdgeA_Out is used for traversal requests starting from SrcVertex, such as <code>(a)-[]-&gt;()</code>; EdgeA_In is used for traversal requests starting from DstVertex, such as <code>()-[]-&gt;(a)</code>.</p><p>Like EdgeA_Out and EdgeA_In, Nebula Graph redundantly stores the information of each edge, which doubles the actual capacities needed for edge storage. The key corresponding to the edge occupies a small hard disk space, but the space occupied by Value is proportional to the length and amount of the property value. Therefore, it will occupy a relatively large hard disk space if the property value of the edge is large or there are many edge property values.</p><p>To ensure the final consistency of the two key-value pairs when operating on edges, enable the <a href="/docs/next/introduction/5.configurations-and-logs/1.configurations/3.graph-config.md/">TOSS function</a>. After that, the operation will be performed in Partition x first where the out-edge is located, and then in Partition y where the in-edge is located. Finally, the result is returned.
--&gt;</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="partition-algorithm">Partition algorithm<a class="hash-link" href="#partition-algorithm" title="Direct link to heading">​</a></h3><p>Nebula Graph uses a <strong>static Hash</strong> strategy to shard data through a modulo operation on vertex ID. All the out-keys, in-keys, and tag data will be placed in the same partition. In this way, query efficiency is increased dramatically.</p><p>!!! Note</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">The number of partitions needs to be determined when users are creating a graph space since it cannot be changed afterward. Users are supposed to take into consideration the demands of future business when setting it.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When inserting into Nebula Graph, vertices and edges are distributed across different partitions. And the partitions are located on different machines. The number of partitions is set in the CREATE SPACE statement and cannot be changed afterward.</p><p>If certain vertices need to be placed on the same partition (i.e., on the same machine), see <a href="https://github.com/vesoft-inc/nebula-common/blob/master/src/common/clients/meta/MetaClient.cpp" target="_blank" rel="noopener noreferrer">Formula/code</a>.</p><p>The following code will briefly describe the relationship between VID and partition.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// If VertexID occupies 8 bytes, it will be stored in int64 to be compatible with the version 1.0.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">uint64_t vid = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (id.size() == 8) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    memcpy(static_cast&lt;void*&gt;(&amp;vid), id.data(), 8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">} else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MurmurHash2 hash;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vid = hash(id.data());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PartitionID pId = vid % numParts + 1;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Roughly speaking, after hashing a fixed string to int64, (the hashing of int64 is the number itself), do modulo, and then plus one, namely:</p><div class="language-C++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pId = vid % numParts + 1;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Parameters and descriptions of the preceding formula are as follows:</p><table><thead><tr><th align="left">Parameter</th><th align="left">Description</th></tr></thead><tbody><tr><td align="left"><code>%</code></td><td align="left">The modulo operation.</td></tr><tr><td align="left"><code>numParts</code></td><td align="left">The number of partitions for the graph space where the <code>VID</code> is located, namely the value of <code>partition_num</code> in the <a href="/docs/next/introduction/3.ngql-guide/9.space-statements/1.create-space.md/">CREATE SPACE</a> statement.</td></tr><tr><td align="left"><code>pId</code></td><td align="left">The ID for the partition where the <code>VID</code> is located.</td></tr></tbody></table><p>Suppose there are 100 partitions, the vertices with <code>VID</code> 1, 101, and 1001 will be stored on the same partition. But, the mapping between the partition ID and the machine address is random. Therefore, we cannot assume that any two partitions are located on the same machine.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="raft">Raft<a class="hash-link" href="#raft" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="raft-implementation">Raft implementation<a class="hash-link" href="#raft-implementation" title="Direct link to heading">​</a></h3><p>In a distributed system, one data usually has multiple replicas so that the system can still run normally even if a few copies fail. It requires certain technical means to ensure consistency between replicas.</p><p>Basic principle: Raft is designed to ensure consistency between replicas. Raft uses election between replicas, and the (candidate) replica that wins more than half of the votes will become the Leader, providing external services on behalf of all replicas. The rest Followers will play backups. When the Leader fails (due to communication failure, operation and maintenance commands, etc.), the rest Followers will conduct a new round of elections and vote for a new Leader. The Leader and Followers will detect each other&#x27;s survival through heartbeats and write them to the hard disk in Raft-wal mode. Replicas that do not respond to more than multiple heartbeats will be considered faulty.</p><p>!!! Note</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Raft-wal needs to be written into the hard disk periodically. If hard disk bottlenecks to write, Raft will fail to send a heartbeat and conduct a new round of elections. If the hard disk IO is severely blocked, there will be no Leader for a long time.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Read and write: For every writing request of the clients, the Leader will initiate a Raft-wal and synchronize it with the Followers. Only after over half replicas have received the Raft-wal will it return to the clients successfully. For every reading request of the clients, it will get to the Leader directly, while Followers will not be involved.</p><p>Failure: Scenario 1: Take a (space) cluster of a single replica as an example. If the system has only one replica, the Leader will be itself. If failure happens, the system will be completely unavailable. Scenario 2: Take a (space) cluster of three replicas as an example. If the system has three replicas, one of them will be the Leader and the rest will be the Followers. If the Leader fails, the rest two can still vote for a new Leader (and a Follower), and the system is still available. But if any of the two Followers fails again, the system will be completely unavailable due to inadequate voters.</p><p>!!! Note</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Raft and HDFS have different modes of duplication. Raft is based on a quorum vote, so the number of replicas cannot be even.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="multi-group-raft">Multi Group Raft<a class="hash-link" href="#multi-group-raft" title="Direct link to heading">​</a></h3><p>The Storage Service supports a distributed cluster architecture, so Nebula Graph implements Multi Group Raft according to Raft protocol. Each Raft group stores all the replicas of each partition. One replica is the leader, while others are followers. In this way, Nebula Graph achieves strong consistency and high availability. The functions of Raft are as follows.</p><p>Nebula Graph uses Multi Group Raft to improve performance when there are many partitions because Raft-wal cannot be NULL. When there are too many partitions, costs will increase, such as storing information in Raft group, WAL files, or batch operation in low load.</p><p>There are two key points to implement the Multi Raft Group:</p><ul><li><p>To share transport layer</p><p> Each Raft Group sends messages to its corresponding peers. So if the transport layer cannot be shared, the connection costs will be very high.</p></li><li><p>To share thread pool</p><p>Raft Groups share the same thread pool to prevent starting too many threads and a high context switch cost.</p></li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="batch">Batch<a class="hash-link" href="#batch" title="Direct link to heading">​</a></h3><p>For each partition, it is necessary to do a batch to improve throughput when writing the WAL serially. As Nebula Graph uses WAL to implement some special functions, batches need to be grouped, which is a feature of Nebula Graph.</p><p>For example, lock-free CAS operations will execute after all the previous WALs are committed. So for a batch, if there are several WALs in CAS type, we need to divide this batch into several smaller groups and make sure they are committed serially.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="transfer-leadership">Transfer Leadership<a class="hash-link" href="#transfer-leadership" title="Direct link to heading">​</a></h3><p>Transfer leadership is extremely important for balance. When moving a partition from one machine to another, Nebula Graph first checks if the source is a leader. If so, it should be moved to another peer. After data migration is completed, it is important to <a href="/docs/next/introduction/8.service-tuning/load-balance.md/">balance leader distribution</a> again.</p><p>When a transfer leadership command is committed, the leader will abandon its leadership and the followers will start a leader election.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="peer-changes">Peer changes<a class="hash-link" href="#peer-changes" title="Direct link to heading">​</a></h3><p>To avoid split-brain, when members in a Raft Group change, an intermediate state is required. In such a state, the quorum of the old group and new group always have an overlap. Thus it prevents the old or new group from making decisions unilaterally. To make it even simpler, in his doctoral thesis Diego Ongaro suggests adding or removing a peer once to ensure the overlap between the quorum of the new group and the old group. Nebula Graph also uses this approach, except that the way to add or remove a member is different. For details, please refer to addPeer/removePeer in the Raft Part class.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cache">Cache<a class="hash-link" href="#cache" title="Direct link to heading">​</a></h2><p>The cache management of RocksDB can not cache vertices or edges on demand. Nebula Graph implements its own cache management for Storage, allowing you to set the storage cache size, content, etc. For more information, see <a href="/docs/next/introduction/5.configurations-and-logs/1.configurations/4.storage-config.md/">Storage cache configurations</a>.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="differences-with-hdfs">Differences with HDFS<a class="hash-link" href="#differences-with-hdfs" title="Direct link to heading">​</a></h2><p>The Storage Service is a Raft-based distributed architecture, which has certain differences with that of HDFS. For example:</p><ul><li><p>The Storage Service ensures consistency through Raft. Usually, the number of its replicas is odd to elect a leader. However, DataNode used by HDFS ensures consistency through NameNode, which has no limit on the number of replicas.</p></li><li><p>In the Storage Service, only the replicas of the leader can read and write, while in HDFS all the replicas can do so.</p></li><li><p>In the Storage Service, the number of replicas needs to be determined when creating a space, since it cannot be changed afterward. But in HDFS, the number of replicas can be changed freely.</p></li><li><p>The Storage Service can access the file system directly. While the applications of HDFS (such as HBase) have to access HDFS before the file system, which requires more RPC times.</p></li></ul><p>In a word, the Storage Service is more lightweight with some functions simplified and its architecture is simpler than HDFS, which can effectively improve the read and write performance of a smaller block of data.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/randomJoe211/randomjoe211.github.io/edit/main/docs/2.introduction/5.nebula-graph-architecture/4.storage-service.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/next/introduction/nebula-graph-architecture/graph-service/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Graph Service</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/next/introduction/data-model/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Data modeling</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#advantages" class="table-of-contents__link toc-highlight">Advantages</a></li><li><a href="#the-architecture-of-the-storage-service" class="table-of-contents__link toc-highlight">The architecture of the Storage Service</a></li><li><a href="#storage-writing-process" class="table-of-contents__link toc-highlight">Storage writing process</a></li><li><a href="#kvstore" class="table-of-contents__link toc-highlight">KVStore</a></li><li><a href="#data-storage-structure" class="table-of-contents__link toc-highlight">Data storage structure</a><ul><li><a href="#property-descriptions" class="table-of-contents__link toc-highlight">Property descriptions</a></li></ul></li><li><a href="#data-partitioning" class="table-of-contents__link toc-highlight">Data partitioning</a><ul><li><a href="#edge-partitioning-and-storage-amplification" class="table-of-contents__link toc-highlight">Edge partitioning and storage amplification</a></li><li><a href="#partition-algorithm" class="table-of-contents__link toc-highlight">Partition algorithm</a></li></ul></li><li><a href="#raft" class="table-of-contents__link toc-highlight">Raft</a><ul><li><a href="#raft-implementation" class="table-of-contents__link toc-highlight">Raft implementation</a></li><li><a href="#multi-group-raft" class="table-of-contents__link toc-highlight">Multi Group Raft</a></li><li><a href="#batch" class="table-of-contents__link toc-highlight">Batch</a></li><li><a href="#transfer-leadership" class="table-of-contents__link toc-highlight">Transfer Leadership</a></li><li><a href="#peer-changes" class="table-of-contents__link toc-highlight">Peer changes</a></li></ul></li><li><a href="#cache" class="table-of-contents__link toc-highlight">Cache</a></li><li><a href="#differences-with-hdfs" class="table-of-contents__link toc-highlight">Differences with HDFS</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learning</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro/">NebulaGraph Database</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/intro/">NebulaGraph Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/intro/">Training Center</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://app.slack.com/client/TJB3N2BPD/CJNFUM7AR" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/vesoft-inc/nebula/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/NebulaGraph" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://nebula-graph.io/download" target="_blank" rel="noopener noreferrer" class="footer__link-item">Download Center</a></li><li class="footer__item"><a href="https://nebula-graph.io/posts" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/vesoft-inc/nebula" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 vesoft inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e8bfd649.js"></script>
<script src="/assets/js/main.e9b606a3.js"></script>
</body>
</html>